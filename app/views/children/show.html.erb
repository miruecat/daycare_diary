<div class="container">
  <%# <%= @child.parents.map(&:fullname) %>
  <% if current_user.role == "parent" && current_user.children.count > 1 %>
    <div class="d-flex justify-content-center container-normal">
      <% current_user.children.each do |child| %>
        <%= link_to child_path(child) do %>
          <div data-bs-toggle="tooltip" data-bs-placement="left" title="<%= child.first_name %>">
            <%= cl_image_tag child.profile_picture.key, class: 'avatar-large-link', crop: :fill %>
          </div>
        <% end %>
      <% end %>
    </div>
  <% elsif current_user.role == "employee" %>
    <div class="d-flex justify-content-center container-normal">
      <div>
        <%= cl_image_tag @child.profile_picture.key, class: 'avatar-large', crop: :fill %>
      </div>
    </div>
  <% end %>

  <div class="container-normal d-flex justify-content-center">
    <div class= "container-button-position">
      <div class="child_name_show d-flex justify-content-center">
        <h1><%= @child.first_name %> <%= @child.last_name %></h1>
        <% if current_user.role == "employee" %>
          <i class="fas fa-info-circle" data-toggle="modal" data-target="#personalInformation"></i>

          <div class="modal fade" id="personalInformation" tabindex="-1" role="dialog" aria-labelledby="personalInformationLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="personalInformationLabel">Personal information of <%= @child.first_name %></h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <p>Birthday: <%= @child.birthdate.strftime("%d-%m-%Y") %></p>
                  <p>Parent 1: <%= @child.parenthoods[0].user.first_name %> <%= @child.parenthoods[0].user.last_name %> <em>(<%= @child.parenthoods[0].user.phone_number %>)</em></p>
                  <% if @child.parenthoods.count > 1 %>
                    <p>Parent 2: <%= @child.parenthoods[1].user.first_name %> <%= @child.parenthoods[1].user.last_name %> <em>(<%= @child.parenthoods[1].user.phone_number %>)</em></p>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>

      <% if current_user.role == "employee" %>
        <div class="employeeforms d-flex justify-content-center">
          <!-- Button trigger modal -->
          <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#moment" id="momentbutton">
          Add a special moment
          </button>
        </div>
    </div>

              <!-- Modal -->

    <div class="modal fade" id="moment" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalCenterTitle">The Moment</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <%= simple_form_for @activity do |f| %>
              <%= f.input :children_id, as: :hidden, input_html: { value: [@child.id] }   %>
              <%= f.hidden_field :category, value: "moment" %>
              <%= f.input :pictures, as: :file, input_html: { multiple: true }%>
              <%= f.input :sub_category, label: false, as: :hidden, input_html: { value: "moment" } %>
              <%= f.input :date %>
              <%= f.input :time %>
              <%= f.input :comment, label: "message" %>
              <%= f.button :submit %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="container-normal">
    <h4>Add an activity for <%= @child.first_name %></h4>
    <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#sleep" id="sleepbutton">
      Sleep
    </button>

          <!-- Modal -->
    <div class="modal fade" id="sleep" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalCenterTitle">Sleep</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <%= simple_form_for @activity do |f| %>
              <%= f.input :children_id, as: :hidden, input_html: { value: [@child.id] } %>
              <%= f.hidden_field :category, value: "sleep" %>
              <%= f.input :sub_category, label: false, as: :radio_buttons,  collection: [SubCategorySleep::INBED, SubCategorySleep::OUTBED] %>
              <%= f.input :date %>
              <%= f.input :time %>
              <%= f.input :comment %>
              <%= f.button :submit %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container-normal">
              <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#food" id="foodbutton">
      Food
    </button>

            <!-- Modal -->
    <div class="modal fade" id="food" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalCenterTitle">Food</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <%= simple_form_for @activity do |f| %>
              <%= f.input :children_id, as: :hidden, input_html: { value: [@child.id] } %>
              <%= f.hidden_field :category, value: "food" %>
              <%= f.input :sub_category, as: :check_boxes, label: false, collection: [SubCategoryFood::BABY, SubCategoryFood::BREAD, SubCategoryFood::FRUIT, SubCategoryFood::PORR, SubCategoryFood::MILK, SubCategoryFood::NOEAT], input_html: { multiple: true } %>
              <%= f.input :date %>
              <%= f.input :time %>
              <%= f.input :comment %>
              <%= f.button :submit %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container-normal">
              <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#health" id="healthbutton">
      Health
    </button>
            <!-- Modal -->
    <div class="modal fade" id="health" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalCenterTitle">Health</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <%= simple_form_for @activity do |f| %>
              <%= f.input :children_id, as: :hidden, input_html: { value: [@child.id] }   %>
              <%= f.hidden_field :category, value: "health" %>
              <%= f.input :sub_category, as: :radio_buttons, label: false, collection: [SubCategoryHealth::GOOD, SubCategoryHealth::SOSO, SubCategoryHealth::SICK] %>
              <%= f.input :date %>
              <%= f.input :time %>
              <%= f.input :comment %>
              <%= f.button :submit %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container-normal">
            <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#play" id="playbutton">
      Play
    </button>

            <!-- Modal -->
    <div class="modal fade" id="play" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalCenterTitle">Play</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <%= simple_form_for @activity do |f| %>
                <%= f.input :children_id, as: :hidden, input_html: { value: [@child.id] }   %>
              <%= f.hidden_field :category, value: "play" %>
              <%= f.input :sub_category, as: :radio_buttons, label: false, collection: [SubCategoryPlay::INSIDE, SubCategoryPlay::OUTSIDE] %>
              <%= f.input :date %>
              <%= f.input :time %>
              <%= f.input :comment %>
              <%= f.button :submit %>
            <% end %>
          </div>
        </div>
      </div>
    </div>

  </div>
  <% end %>




    <div class="container-large-top">
      <h2>Activity log of <%= @child.first_name %></h2>
      <div class="container-normal">
        <label for="start">Selected date:</label>
        <input type="date" id="date-activities" name="trip-start"
          value="<%= Date.today %>" min="2020-01-01" max="<%= Date.today %>">
      </div>
      <div class="row">
      <div class="col-md-12">
        <div id="content">
          <ul class="timeline">
            <% @child.activities.each do |activity| %>
              <div class="activity-row <%= 'd-none' unless activity.date == Date.today %>" data-date="<%= activity.date.strftime("%Y-%m-%d") %>">
                <li class="event" scope="row" data-date="<%= activity.sub_category %>">
                  <h3><%= activity.category %> - <%= activity.sub_category %>
                    <% if current_user.role == "employee" %>
                      <em>(<%= link_to "Delete", activity_path(activity), method: :delete, data: { confirm: "Are you sure?" } %>)</em>
                    <% end %>
                    </h3>
                  <p><em><%= activity.time.strftime("%H:%M") %>h</em></p>
                  <p><em><%= activity.comment %></em></p>
                  <br>
                </li>
              </div>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
    </div>

    <div class="carousel-top-container container-normal">
      <div class="carouselContainer">
        <div id="carouselExampleFade" class="carousel slide carousel-fade" data-ride="carousel">
          <div class="carousel-inner">
            <% @child.activity_pictures.each do |activity_picture| %>
              <% if activity_picture == @child.activity_pictures.first %>
                <div class="carousel-item active d-flex justify-content-center">
                  <%= cl_image_tag activity_picture.key, class: "d-block image-carousel" %>
                </div>
                <% else %>
                <div class="carousel-item d-flex justify-content-center">
                  <%= cl_image_tag activity_picture.key, class: "d-block image-carousel" %>
                </div>
              <% end %>
            <% end %>
          </div>
          <% if @child.activity_pictures.count > 1%>
            <a class="carousel-control-prev" href="#carouselExampleFade" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleFade" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          <% end %>
        </div>
      </div>
    </div>

    <div class="container-large-top">
      <% if policy(Parenthood).create? && current_user.admin == true %>
        <%= simple_form_for [@child, @parenthood] do |f| %>
        <%= f.association :user, collection: User.parents, label_method: :fullname, value_method: :id %>
        <%= f.button :submit, "Assign a Parent", id: "main-btn" %>
        <% end %>
      <% end %>
    </div>

</div>
